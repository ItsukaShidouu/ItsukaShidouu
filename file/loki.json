{
    "_comment": "UPDATED EGG: Loki for Pterodactyl Panel — updated for 2025 compatibility",
    "meta": {
        "version": "PTDL_v2",
        "update_url": null
    },
    "exported_at": "2025-10-15T00:00:00+07:00",
    "name": "Loki",
    "author": "support@ness.biz.id",
    "description": "Grafana Loki — log aggregation system. This egg runs Loki standalone; you may connect Promtail or Prometheus-compatible agents to it.",
    "docker_images": {
        "ghcr.io/parkervcp/yolks:debian": "ghcr.io/parkervcp/yolks:debian"
    },
    "file_denylist": [],
    "startup": "./loki-linux-amd64 -config.file=loki-config.yaml",
    "config": {
        "files": "{\r\n  \"loki-config.yaml\": {\r\n    \"parser\": \"yaml\",\r\n    \"find\": {\r\n      \"server.http_listen_port\": \"{{server.build.default.port}}\",\r\n      \"common.path_prefix\": \"/home/container/loki\",\r\n      \"common.storage.filesystem.chunks_directory\": \"/home/container/loki/chunks\",\r\n      \"common.storage.filesystem.rules_directory\": \"/home/container/loki/rules\",\r\n      \"common.ring.instance_addr\": \"0.0.0.0\"\r\n    }\r\n  }\r\n}",
        "startup": "{\r\n  \"done\": \"server started\",\r\n  \"userInteraction\": []\r\n}",
        "logs": "{}",
        "stop": "^C"
    },
    "scripts": {
        "installation": {
            "script": "#!/bin/bash\r\ncd /mnt/server\r\napt update -y && apt install -y curl unzip jq\r\n\r\nARCH=$( [[ \"$(uname -m)\" == \"x86_64\" ]] && echo \"amd64\" || echo \"arm64\" )\r\n\r\nif [ \"$LOKI_VERSION\" = \"latest\" ] || [ -z \"$LOKI_VERSION\" ]; then\r\n  LOKI_VERSION=$(curl -s https://api.github.com/repos/grafana/loki/releases/latest | jq -r .tag_name | sed 's/v//')\r\nfi\r\n\r\necho \"Installing Loki v${LOKI_VERSION} (${ARCH})...\"\r\ncurl -L -o loki.zip https://github.com/grafana/loki/releases/download/v${LOKI_VERSION}/loki-linux-${ARCH}.zip\r\nunzip loki.zip && rm -f loki.zip\r\n\r\ncurl -L -o loki-config.yaml https://raw.githubusercontent.com/grafana/loki/v${LOKI_VERSION}/cmd/loki/loki-local-config.yaml\r\nchmod +x loki-linux-${ARCH}\r\nmv loki-linux-${ARCH} loki-linux-amd64\r\n\r\necho \"✅ Loki installation complete!\"\r\nexit 0",
            "container": "ghcr.io/parkervcp/installers:debian",
            "entrypoint": "bash"
        }
    },
    "variables": [
        {
            "name": "Loki Version",
            "description": "The Loki release version. Example: 3.1.1 — leave blank or set 'latest' to auto-detect from GitHub.",
            "env_variable": "LOKI_VERSION",
            "default_value": "latest",
            "user_viewable": true,
            "user_editable": true,
            "rules": "required|string|max:20",
            "field_type": "text"
        }
    ]
}
